@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix v-s: <http://semantic-machines.com/veda/veda-schema/> .
@prefix v-ui: <http://semantic-machines.com/veda/veda-ui/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix cfg: <http://semantic-machines.com/veda/config/> .
@prefix v-fs: <http://semantic-machines.com/veda/veda-function-search/> .
@prefix v-fc: <http://semantic-machines.com/veda/veda-function-create/> .

<http://semantic-machines.com/veda/veda-function-news>
  rdf:type owl:Ontology ;
  rdfs:label "Онтология функции 'Новость' системы Веда"@ru ;
  rdfs:label "Veda system function 'News' ontology"@en ;
#  owl:versionInfo "0.2" ;
  v-s:loadPriority 9 ;
.

########## NEWS FUNCTION ###########

v-s:News
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:UserThing;
  rdfs:subClassOf v-s:Codelet;
  rdfs:subClassOf v-s:Labeled;
  rdfs:label "Новость"@ru ;
  rdfs:label "News"@en ;
  v-s:labelPattern "{@.v-s:title} {@.v-s:created}" ;
.

v-s:newsAudience
  rdf:type owl:ObjectProperty ;
  rdfs:label "Аудитория новости"@ru ;
  rdfs:label "News audience"@en ;
  rdfs:domain v-s:News ;
  rdfs:range rdfs:Resource ;
.

v-s:PS_newsAudience
  rdf:type v-ui:ObjectPropertySpecification ;
  rdfs:label "Спецификация свойства v-s:newsAudience для класса v-s:News"@ru ;
  rdfs:label "v-s:newsAudience property specification for v-s:News class"@en ;
  v-ui:forClass v-s:News ;
  v-ui:forProperty v-s:newsAudience ;
  v-ui:minCardinality 1 ;
  v-ui:maxCardinality 100 ;
  v-ui:queryPrefix "('rdf:type' == 'v-s:OrganizationUnit' || 'rdf:type' === 'v-s:Group')" ;
.

v-s:NotifyBundle
  rdf:type v-s:Bundle ;
  rdfs:label "Уведомить пользователей"@ru ;
  rdfs:label "Notify users"@en ;
.

v-s:AllNotificationsBundle
  rdf:type v-s:Bundle ;
  rdfs:label "Все уведомления"@ru ;
  rdfs:label "All notifications"@en ;
.

v-s:TS_News
  rdf:type v-ui:TemplateSpecification;
  v-s:loadPriority "15"^^xsd:integer;
  v-ui:defaultTemplate "v-s_NewsTemplate.html";
  v-ui:forClass v-s:News
.
v-s:NewsBlank
  rdf:type v-fc:Blank ;
  rdfs:label "Новость"@ru ;
  rdfs:label "News"@en ;
  v-fc:targetType v-s:News ;
.

v-s:NewsCreate
  rdf:type v-fc:Create ;
  rdfs:label "Новость"@ru ;
  rdfs:label "News"@en ;
  v-fc:hasBlank v-s:NewsBlank ;
.

v-s:NewsSearchUser
  rdf:type v-fs:AttributiveSearch ;
  rdfs:label "Новости"@ru ;
  rdfs:label "News"@en ;
  v-fs:searchBlank v-s:NewsBlank ;
  v-fs:searchResultTemplate "v-s_NewsSearchUserResultTemplate.html" ;
  v-fs:searchOnLoad true ;
  v-ui:hasTemplate "v-fs_AttributiveSearchTemplate.html" ;
.
v-s:NewsSearch
  rdf:type v-fs:AttributiveSearch ;
  rdfs:label "Новости"@ru ;
  rdfs:label "News"@en ;
  v-fs:searchBlank v-s:NewsBlank ;
  v-fs:searchBlankTemplate "v-s_NewsSearchBlankTemplate.html" ;
  v-fs:searchResultTemplate "v-s_NewsSearchResultTemplate.html" ;
  v-fs:searchOnLoad true ;
.
########## УПРАВЛЕНИЕ ПРАВАМИ ###########

v-s:News_permission
  rdf:type v-s:PermissionStatement ;
  v-s:permissionObject v-s:News_group ;
  v-s:permissionSubject cfg:AllUsersGroup ;
  v-s:canRead "true"^^xsd:boolean ;
  rdfs:label "R. Все пользователи. Класс v-s:News" ;
.

########## ИНДИВИДЫ ###########

v-s:NewsReloadPage
  rdf:type v-s:News;
  rdfs:label "Версия приложения обновилась"@ru;
  rdfs:label "Application was updated"@en;
  v-s:title "Версия приложения изменилась!"@ru;
  v-s:title "Application version changed!"@en;
  v-s:content """
  Необходимо обновить страницу.

  Обновить сейчас?
  """@ru;
  v-s:content """
  Page must be reloaded.

  Reload now?
  """@en;
  v-s:script """
var delReq = window.indexedDB.deleteDatabase("veda");
delReq.onerror = console.log;
delReq.onsuccess = console.log;
document.cookie = "ticket=null; expires=" + new Date(0).toGMTString() + "; path=/files;";
setTimeout(function () {
  location.reload();
}, 3000);
  """;
  v-s:newsAudience cfg:AllUsersGroup;
.
